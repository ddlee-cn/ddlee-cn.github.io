<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Deep Learning in Scientific Research: My Best Practices | LI, Jiacheng (李 家丞) </title> <meta name="author" content="Jiacheng LI"> <meta name="description" content="A guide to implementing deep learning models for scientific research, with a focus on reproducibility, data management, and model evaluation."> <meta name="keywords" content="Jiacheng Li, Sony Research, Sony AI, Sony, USTC"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ddlee-cn.github.io/blog/2019/Best-Practice/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> LI, Jiacheng (李 家丞) </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Research </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/computational-photography/">Computational Photography</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/rendering-&amp;-generative-ai/">Rendering &amp; Genenerative AI</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/streaming-&amp;-display/">Streaming &amp; Display</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/intelligent-sensing/">Intelligent Sensing</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Deep Learning in Scientific Research: My Best Practices</h1> <p class="post-meta"> Created on May 04, 2019 </p> <p class="post-tags"> <a href="/blog/2019"> <i class="fa-solid fa-calendar fa-sm"></i> 2019 </a>   ·   <a href="/blog/tag/all"> <i class="fa-solid fa-hashtag fa-sm"></i> all</a>   <a href="/blog/tag/research"> <i class="fa-solid fa-hashtag fa-sm"></i> research</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Inspired by Karpathy’s impressive post <a href="http://karpathy.github.io/2019/04/25/recipe/" rel="external nofollow noopener" target="_blank">A Recipe for Training Neural Networks</a>, I decided to review and share my daily route of engineering works on Machine Learning related research. Compared to Karpathy’s advice, I’d like to talk more about approaches or practices instead of strategies. This article is merely a personal revision from a newbie, so any suggestions are welcomed.</p> <h2 id="the-philosophy"><strong>The Philosophy</strong></h2> <blockquote> <p>Everything is a file.</p> <p>– <cite>one of defining features of Unix</cite></p> </blockquote> <p>I believe that it is extremely important to learn from failures, before which recording and observing may be the first step. So I’m obsessed with store and organize everything for future review.</p> <h2 id="dataset"><strong>Dataset+</strong></h2> <p>I added a plus symbol to emphasize the difference between the original dataset and experiment-usable dataset. From my point of view, a dataset+ may include the following parts:</p> <ul> <li>raw images and label file provided by the authors</li> <li>an explore script/notebook to view images and labels</li> <li>a README file which contains info about the dataset: image numbers, image shape, etc</li> <li>a toy dataset whose folder structure is exactly the same as original dataset for running toy example and debug quickly</li> <li>framework-specific formats for fast I/O during training: <code class="language-plaintext highlighter-rouge">tf.record</code>, <code class="language-plaintext highlighter-rouge">.lmdb</code>, etc</li> <li>several list file which contains image names and absolute path of image file</li> </ul> <h2 id="devlopment-environment"><strong>Devlopment Environment</strong></h2> <p>Because of a) the complicated and unstable optimization process b) fast-developing frameworks c) data dependency, the reproduction problem is one of bad reputations of learning-based methods. For a proposed learning-based model, not only the algorithms described in paper, but also its entire reproduction stack as well as the datasets should be taken notice of.</p> <p><img src="/assets/img/posts/ML-Stack.png" alt="ML-stack"></p> <p>Thanks to container technology and Python environment management tools, namely Docker and <code class="language-plaintext highlighter-rouge">virtualenv</code> etc, we’ve got much more control on the environment where our codes run. I prepared two <code class="language-plaintext highlighter-rouge">Dockerfile</code>s, one of which is for development and another for production (release). Upon docker images, a virtual env will be created for each project. A lot of tools is useful for environment management in Python, including <code class="language-plaintext highlighter-rouge">conda-env</code>, <code class="language-plaintext highlighter-rouge">pyenv</code>, <code class="language-plaintext highlighter-rouge">peotry</code>, <code class="language-plaintext highlighter-rouge">pipenv</code>, or just a <code class="language-plaintext highlighter-rouge">requirements.txt</code> file.</p> <p>Every time running an experiment, a docker container will be built and only projects dependencies are installed, which both can be totally controlled through <code class="language-plaintext highlighter-rouge">Dockerfile</code> and <code class="language-plaintext highlighter-rouge">requirements.txt</code> (or equivalents).</p> <h2 id="experiment-management"><strong>Experiment Management</strong></h2> <h3 id="codes">Codes</h3> <p>All codes are monitored using <code class="language-plaintext highlighter-rouge">git</code>, with at least one commit per day if any files changed. I once suffered a lot from a unintentional bug which can be found immediately if I used VCS in my early days. I encourage myself to only write codes which can be released.</p> <h3 id="configs">Configs</h3> <p>Configs mainly include hyper-parameters of an experiment. Common items are: dataset root directory, output directory, checkpoints directory, learning rate, batch size, GPU ids, epochs, input shapes, loss weight, etc. I think that a perfect configure system should be:</p> <ul> <li> <strong>Serialized</strong>. The configs should be reusable across time and machines.</li> <li> <strong>Readable</strong>. Easy to understand for human(both authors and others).</li> </ul> <h4 id="current-options">Current options:</h4> <ul> <li> <strong>shell script/command line + <code class="language-plaintext highlighter-rouge">argparse</code></strong>: easy to implement, need extra effort to manage scripts. e.g. <a href="https://github.com/NVlabs/SPADE" rel="external nofollow noopener" target="_blank">SPADE</a> </li> <li> <strong>YAML files + <code class="language-plaintext highlighter-rouge">config</code> variable</strong>: require utility functions to parse YAML files and update <code class="language-plaintext highlighter-rouge">config</code>. e.g. <a href="https://github.com/hanzhanggit/StackGAN-v2" rel="external nofollow noopener" target="_blank">StackGAN-v2</a> </li> <li> <strong>Python <code class="language-plaintext highlighter-rouge">dict</code></strong>: easy to implement, but add unnecessary code pieces. e.g. <a href="https://github.com/open-mmlab/mmdetection" rel="external nofollow noopener" target="_blank">mmdetection</a> </li> <li> <strong>Google’s Gin</strong>: similar to YAML files, require <code class="language-plaintext highlighter-rouge">gin</code> package. e.g. <a href="https://github.com/google/compare_gan" rel="external nofollow noopener" target="_blank">compare_gan</a> </li> </ul> <h3 id="checkpoints-logs-and-visualization">Checkpoints, Logs and Visualization</h3> <p>I used to create a <code class="language-plaintext highlighter-rouge">checkpoint</code> folder under my home directory and organize checkpoints based on projects and datasets. On the other hand, a <code class="language-plaintext highlighter-rouge">model</code> folder is created for pretrained models and released models. They are usually shared across projects. Inside projects, different runs are identified with starting time.</p> <p>Logs are stored in the corresponding <code class="language-plaintext highlighter-rouge">checkpoint</code> folder during training, with stack version, hyper-params, train loss per batch and val loss per epoch recorded. I also store middle results in a separate folder for debug. Some scripts for parsing logs are required.</p> <p>Tools like <code class="language-plaintext highlighter-rouge">Tensorboard</code> and <code class="language-plaintext highlighter-rouge">Visdom</code> are useful for visualizing loss changes on the fly during training. Furthermore, they can basically record nearly everything. However, they usually need additional ports and eat memory. It’s recommended to mount the <code class="language-plaintext highlighter-rouge">log</code> folder and then run these visualization tools on another machine.</p> <h3 id="outputs">Outputs</h3> <p>The <code class="language-plaintext highlighter-rouge">output</code> folder is where I store predicted images, numpy arrays, and text files for evaluation (validation set) or submission (test set). In this way, the evaluation process can be decoupled from the training process, and it’s rather suitable when comparing different methods (or models from different runs).</p> <h2 id="misc"><strong>Misc</strong></h2> <h3 id="playground">Playground</h3> <p>The playground refers to a super environment for trying new codes, packages or getting familiar with some functions. It can also be a single jupyter notebook inside the project folder.</p> <h3 id="jobs-and-scripts">Jobs and Scripts</h3> <p>Shell scripts to bundle a series works for an environment, e.g. a <em>preprocessing-training-evaluation-visualization-test</em> pipeline.</p> <h3 id="debug-folder">Debug Folder</h3> <p>Debug folder stores anything provide insights from debugging process. It also serves as a transfer station between training nodes and my personal computer.</p> <h3 id="inline-notes">Inline Notes</h3> <p>I often writing notes as comments inside codes and <code class="language-plaintext highlighter-rouge">git</code> comments. They will be reorganized to note-taking apps during the review process.</p> <h2 id="final-thoughts"><strong>Final Thoughts</strong></h2> <p>I hope that creativity is the only constraint of my research, not engineering. Thanks for your time and feel free to share your thoughts with me.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/DLSS4/">NVIDIA DLSS 4</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/AMD-FSR/">AMD FidelityFX Super Resolution</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/CG-Pipeline/">The Real-Time Rendering Pipeline</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Jiacheng LI. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>